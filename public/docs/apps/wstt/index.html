<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>IoT Labs</title>

    <!-- Custom fonts for this template-->
    <link href="../../vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="../../css/sb-admin-2.min.css" rel="stylesheet">

    <link rel="stylesheet" href="../../../assets/css/imt.css">

    <link rel="stylesheet" href="../../css/codeFormatting.css">
</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-dark sidebar sidebar-dark accordion" id="accordionSidebar">

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="/docs">
                <div class="sidebar-brand-icon">
                    <img src="../../../assets/img/imt-Logo.jpg" height="70rem">
                </div>
                <div class="sidebar-brand-text mx-3">IoT Labs</sup></div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="/docs">
                    <!-- <i class="fas fa-fw fa-tachometer-alt"></i> -->
                    <span>Introducción</span></a>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                API
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item active">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <img src="../../../assets/img/icons/app.white.svg">
                    <span>Aplicaciones</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="/docs/apps/intro/">Introducción</a>
                        <a class="collapse-item" href="/docs/apps/editor/">Editor</a>
                        <a class="collapse-item" href="/docs/apps/layout/">Layout</a>
                        <a class="collapse-item" href="/docs/apps/wstt/">Comunicación</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                    aria-expanded="true" aria-controls="collapseUtilities">
                    <img src="../../../assets/img/icons/cpu.white.svg">
                    <span>Dispositivos</span>
                </a>
                <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="/docs/devices/intro/">Introducción</a>
                        <a class="collapse-item" href="/docs/devices/mqtt/">Comunicación</a>
                    </div>
                </div>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Herramientas
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapsePages"
                    aria-expanded="true" aria-controls="collapsePages">
                    <img src="../../../assets/img/icons/editor.white.svg">
                    <span>Editor</span>
                </a>
                <div id="collapsePages" class="collapse" aria-labelledby="headingPages" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="/docs/editor/intro/">Introducción</a>
                        <a class="collapse-item" href="/docs/editor/gui/">Interfaz</a>
                        <a class="collapse-item" href="/docs/editor/packaging/">Creación de paquetes</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Charts -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseDataLogger"
                    aria-expanded="true" aria-controls="collapseDataLogger">
                    <img src="../../../assets/img/icons/terminal.white.svg">
                    <span>Data Logger</span>
                </a>
                <div id="collapseDataLogger" class="collapse" aria-labelledby="headingPages" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="/docs/logger/intro/">Introducción</a>
                        <a class="collapse-item" href="/docs/logger/gui/">Interfaz</a>
                        <a class="collapse-item" href="/docs/logger/reports/">Generación de reportes</a>
                    </div>
                </div>
            </li>

            <!-- Divider -->
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>
        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>

                    <h3>Aplicaciones - Comunicación</h3>

                </nav>
                <!-- End of Topbar -->

                <!-- Begin Page Content -->
                <div class="container-fluid">

                    <!-- Page Heading -->
                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">Comunicación - WebSocket</h1>
                    </div>

                    <div class="row mx-2">
                        <p>
                            El cliente basado en WebSockets desarrollado para la plataforma se encuentra disponible en el editor, tanto para realizar pruebas como para desplegar la aplicación en internet.
                            La interfaz pretende ser muy minimalista de modo que tiene todo lo necesario para funcionar y ser fácil de entender
                        </p>
                    </div>

                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">Obteniendo el API key</h1>
                    </div>

                    <div class="row mx-2">
                        <p>
                            Para obtener el API key necesario es necesario con dirigirse a la <a href="/lab/apps/">pantalla de aplicaciones</a> y registrar una aplicación con el botón [+]
                        </p>
                    </div>

                    <div class="row d-flex justify-content-center">
                        <img src="../../../assets/img/createApp-screenshot.png" width="70%">
                    </div>

                    <div class="row mx-2">
                        <p>
                            Al presionar el botón se desplegará una ventana modal con un formulario que requiere los datos de la aplicación.
                            El campo &quot;Acceso&quot; configura la aplicación para que sea accesible únicamente por el usuario que la creó o por cualquiera en internet.
                        </p>
                    </div>

                    <div class="row d-flex justify-content-center">
                        <img src="../../../assets/img/createAppModal-screenshot.png" width="50%">
                    </div>

                    <div class="row mx-2">
                        <p>
                            Por último debes copiar el API key utilizando el cuarto botón en la tarjeta de la aplicación.
                        </p>
                    </div>

                    <div class="row d-flex justify-content-center">
                        <button class="btn btn-primary">
                            <img src="../../../assets/img/icons/copyApiKey.white.svg" width="30rem">
                        </button>
                    </div>
                    
                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">API</h1>
                    </div>

                    <div class="row mx-2">
                        <p>
                            La API hace uso de un elemento de QML para facilitar su acceso y configuración, IoTLabsWS. Todo inicia por la importación del módulo de comunicaciones y
                            continua por la configuran mediante una serie de atributos. Que permiten al cliente conctarse, autenticarse, enviar y recibir mensajes desde y hacia el servidor.
                            La autenticación, al igual que la desconexión se realizan de forma automática por lo que el usuario no debe preocuparse por ello.
                        </p>
                    </div>

                    <!-- Content Row -->
                    <div class="row mx-2">
                        <div>
                            <hr class="my-1">
                            <span class="lineNumber-3">1</span><span class="qml-p-keyword">import</span> QtQuick 2.12 <br>
                            <span class="lineNumber-3">2</span><span class="qml-p-keyword">import</span> QtQuick.Controls 2.12 <br>
                            <span class="lineNumber-3">3</span><span class="qml-p-keyword">import</span> IMT.IoTLabsWS 1.0 <span class="qml-comment">// Importar el módulo de comunicaciones</span> <br>
                            <span class="lineNumber-3">4</span><br>
                            <span class="lineNumber-3">5</span><span class="qml-p-keyword">Item</span> { <br>
                            <span class="lineNumber-3">6</span>    <span class="indent-1"><span class="qml-variable">id</span>: root</span> <br>
                            <span class="lineNumber-3">7</span>    <span class="indent-1 qml-p-keyword">IoTLabsWS</span> { <br>
                            <span class="lineNumber-3">8</span>        <span class="indent-2 qml-variable">id</span>: client <br>
                            <span class="lineNumber-3">9</span>        <span class="indent-2 qml-variable">host</span>: &quot;<span class="qml-string">wss://imt-iotlabs.net</span>&quot; <br>
                            <span class="lineNumber-2">10</span>       <span class="indent-2 qml-variable">appID</span>: &quot;<span class="qml-string">tu appID</span>&quot; <br>
                            <span class="lineNumber-2">11</span>       <span class="indent-2 qml-variable">apiKey</span>: &quot;<span class="qml-string">tu api key</span>&quot; <br>
                            <span class="lineNumber-2">12</span>       <br>
                            <span class="lineNumber-2">13</span>       <span class="indent-2 qml-variable">Component.onCompleted</span>: { <br>
                            <span class="lineNumber-2">14</span>           <span class="indent-3 qml-comment">// Función de JavaScript que se ejecuta cuando el componente termina de cargarse</span> <br>
                            <span class="lineNumber-2">15</span>           <span class="indent-3 qml-function">connectServer</span> () <span class="qml-comment">// Conectarse al servidor</span> <br>
                            <span class="lineNumber-2">16</span>       <span class="indent-2">}</span> <br>
                            <span class="lineNumber-2">17</span>       <span class="indent-2 qml-variable">onConnectionEstablished</span>: { <br>
                            <span class="lineNumber-2">18</span>           <span class="indent-3 qml-comment">// Función de JavaScript que se ejecuta cuando se establece conexión</span> <br>
                            <span class="lineNumber-2">19</span>           <span class="indent-3 qml-function">subscribe</span> ( &quot;<span class="qml-string">topic/to/subscribe</span>&quot; ) <span class="qml-comment">// Subscribirse al topic topic/to/subscribe</span> <br>
                            <span class="lineNumber-2">20</span>       <span class="indent-2">}</span> <br>
                            <span class="lineNumber-2">21</span>       <span class="indent-2 qml-variable">onCredentialsRejected</span>: { <br>
                            <span class="lineNumber-2">22</span>           <span class="indent-3 qml-comment">// Función de JavaScript que se ejecuta cuando las credenciales no son validas</span> <br>
                            <span class="lineNumber-2">23</span>       <span class="indent-2">}</span> <br>
                            <span class="lineNumber-2">24</span>       <span class="indent-2 qml-variable">onMessageRecieved</span>: { <br>
                            <span class="lineNumber-2">25</span>           <span class="indent-3 qml-comment">// Función de JavaScript que se ejecuta cuando se recibe un mensaje</span> <br>
                            <span class="lineNumber-2">26</span>           <span class="indent-3 qml-comment">// En esta función se recibe el argumento message</span> <br>
                            <span class="lineNumber-2">27</span>           <span class="indent-3 qml-variable">let</span> parsedMessage = JSON.<span class="qml-function">parse</span> ( <span class="qml-arg">message</span> ) <span class="qml-comment">// Convertir el mensaje en un objeto de JavaScript</span> <br>
                            <span class="lineNumber-2">28</span>           <br>
                            <span class="lineNumber-2">29</span>           <span class="indent-3 qml-p-keyword">if</span> ( <span class="qml-arg">parsedMessage.topic</span> == &quot;<span class="qml-string">topic/to/subscribe</span>&quot; ) { <br>
                            <span class="lineNumber-2">30</span>               <span class="indent-4 qml-comment">// Procesar el mensaje se debe acceder al mismo con parsedMessage.message</span> <br>
                            <span class="lineNumber-2">31</span>               <span class="indent-4"></span>console.<span class="qml-function">log</span> ( <span class="qml-arg">parsedMessage.message</span> )</span> <span class="qml-comment">// Mostrar el mentaje recibido en la consola del navegador</span> <br>
                            <span class="lineNumber-2">32</span>           <span class="indent-3">}</span> <br>
                            <span class="lineNumber-2">33</span>       <span class="indent-2">}</span> <br>
                            <span class="lineNumber-2">34</span>   <span class="indent-1">}</span> <br>
                            <span class="lineNumber-2">35</span>   <span class="indent-1"><span class="qml-p-keyword">Switch</span> {</span> <br>
                            <span class="lineNumber-2">36</span>       <span class="indent-2 qml-variable">anchors.centerIn</span>: parent <br>
                            <span class="lineNumber-2">37</span>       <span class="indent-2 qml-variable">text</span>: &quot;<span class="qml-string">Switch me!</span>&quot; <br>
                            <span class="lineNumber-2">38</span>       <span class="indent-2 qml-variable">onCheckedChanged</span>: { <br>
                            <span class="lineNumber-2">39</span>           <span class="indent-3 qml-comment">// Función de JavaScript que se ejecuta cuando el switch cambia de estado</span> <br>
                            <span class="lineNumber-2">40</span>           <span class="indent-3 qml-comment">// En esta función se recibe el argumento checked. También es posible manipular otros elementos mediante el id</span> <br>
                            <span class="lineNumber-2">41</span>           <span class="indent-3 qml-p-keyword">if</span> (<span class="qml-arg">checked</span>) { <br>
                            <span class="lineNumber-2">42</span>               <span class="indent-4">client.<span class="qml-function">publish</span> ( &quot;<span class="qml-string">topic/to/publish</span>&quot;, &quot;<span class="qml-string">switch_on</span>&quot;)</span> <span class="qml-comment">// Publicar el mentaje switch_on al topic topic/to/publish</span> <br>
                            <span class="lineNumber-2">43</span>           <span class="indent-3">}</span> <span class="qml-p-keyword">else </span> {<br>
                            <span class="lineNumber-2">44</span>               <span class="indent-4"></span>client.<span class="qml-function">publish</span> ( &quot;<span class="qml-string">topic/to/publish</span>&quot;, &quot;<span class="qml-string">switch_off</span>&quot;)</span> <span class="qml-comment">// Publicar el mentaje switch_off al topic topic/to/publish</span> <br>
                            <span class="lineNumber-2">45</span>           <span class="indent-3">}</span> <br>
                            <span class="lineNumber-2">46</span>       <span class="indent-2">} <br>
                            <span class="lineNumber-2">47</span>   <span class="indent-1">}</span> <br>
                            <span class="lineNumber-2">48</span>}
                            <hr class="my-1">
                            API de comunicación
                            <hr class="my-1">
                        </div>
                    </div>
                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="row">
                        <div class="col">
                            <div class="text-left">
                                <a href="/docs/apps/layout/">&leftarrow; Anterior</a>
                            </div>
                        </div>
                        <div class="col">
                            <div class="container">
                                <div class="copyright text-center my-auto">
                                    <span>Copyright &copy; IMT IoT Labs - 2020</span>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="text-right">
                                <a href="/docs/devices/intro/">Siguiente &rightarrow;</a>
                            </div>
                        </div>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Bootstrap core JavaScript-->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <!-- Custom scripts for all pages-->
    <script src="../../js/sb-admin-2.min.js"></script>
</body>

</html>